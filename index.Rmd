---
title: "Categorical Sequence Analysis with Optimal Matching: An Application with Data from the 'Women 40+ Healthy Aging Study'"
author: 'Adriana Clavijo Daza'
date: 'June 2023'
institution: 'University of Bern'
division: 'Faculty of Science'
advisor: 'Prof. Dr. David Ginsbourger'
altadvisor: 'Dr. Serena Lozza-Fiacco'
department: 'Institute of Mathematical Statistics and Actuarial Science'
degree: 'Master of Science in Statistics and Data Science'
knit: bookdown::render_book
# site: bookdown::bookdown_site

# The next two lines allow you to change the spacing in your thesis. You can 
# switch out \onehalfspacing with \singlespacing or \doublespacing, if desired.
header-includes:
    - \usepackage{setspace}\onehalfspacing
    - \usepackage{algpseudocode}
    - \usepackage{algorithm}

# Remove the hashtag to specify which version of output you would like.
# Can only choose one at a time.
output:
  thesisdown::thesis_pdf: default 
#  thesisdown::thesis_gitbook: default         
#  thesisdown::thesis_word: default
#  thesisdown::thesis_epub: default

# If you are creating a PDF you'll need to write your preliminary content 
# (e.g., abstract, acknowledgements) below or use code similar to line 25-26 
# for the .RMD files. If you are NOT producing a PDF, delete or silence
# lines 25-39 in this YAML header.
abstract: |
  `r if(knitr:::is_latex_output()) paste(readLines("prelims/00-abstract.Rmd"), collapse = "\n  ")`

# If you'd rather include the preliminary content in files instead of inline
# like below, use a command like that for the abstract above.  Note that a tab 
# is needed on the line after the `|`.
acknowledgements: |
  I want to thank a few people.
dedication: |
  You can have a dedication here if you wish. 
preface: |
  This is an example of a thesis setup to use the reed thesis document class 
  (for LaTeX) and the R bookdown package, in general.

# Note that abbreviations in lowercase letters will NOT be automatically
# capitalized.
# abbreviations:
#   ABC: American Broadcasting Company
#   CBS: Colombia Broadcasting System
#   CUS: Computer User Services
#   PBS: Public Broadcasting System
#   NBC: National Broadcasting Company

# Specify the location of the bibliography below
bibliography: bib/thesis.bib

# Download your specific csl file and refer to it in the line below.
csl: csl/apa.csl
lot: true
lof: true
---

<!--
Above is the YAML (YAML Ain't Markup Language) header that includes a lot of 
metadata used to produce the document.  Be careful with spacing in this header!

If you'd prefer to not include a Dedication, for example, simply delete the 
section entirely, or silence them (add # before each line). 

If you have other LaTeX packages you would like to include, delete the # before
header-includes and list the packages after hyphens on new lines.

If you'd like to include a comment that won't be produced in your resulting file
enclose it in a block like this.

If you receive a duplicate label error after knitting, make sure to delete the
index.Rmd file and then knit again.
-->

```{r packages, include = FALSE}
library(readxl)
library(tidyr)
library(dplyr)
library(stringr)
library(ggplot2)
library(TraMineR)
library(TraMineRextras)
library(cluster)
library(extrafont)
```

```{r helpers, include = FALSE}
## Note: this is order dependent.
source("helpers/distance_matrix.R", local = knitr::knit_global())
source("helpers/predict_scores.R", local = knitr::knit_global())
source("helpers/get_MSE.R", local = knitr::knit_global())
```

```{r setup, include = FALSE}
# Global knitr chunk options
## Note: updating global chunk options propagates, invalidate existing cache.
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  # Graphics settings
  fig.align = "center",
  fig.width = 7.5,
  fig.height = 5.25,
  ## Use cairo_pdf to embed fonts in the plots (and preserve it when rendering):
  ## https://stackoverflow.com/a/36663975
  dev = "cairo_pdf",
  ## Font family for base plots. Requires it available via extrafont::
  dev.args = list(family = "Latin Modern Math") ## For base plots.
)

extrafont::loadfonts(device = "all")
# GGplot theme.
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 12))

ggplot2::theme_update(
  ## Default axis labels size is 80% of plot font size. Increasing to 100%.
  axis.text = ggplot2::element_text(size = ggplot2::rel(1)),
  ## Font family. Requires it available via extrafont::
  text = ggplot2::element_text(family = "Latin Modern Math")
)

options(width = 80)
```

<!--
The acknowledgments, preface, dedication, and abstract are added into the PDF
version automatically by inputting them in the YAML at the top of this file.
Alternatively, you can put that content in files like 00--prelim.Rmd and
00-abstract.Rmd like done below.
-->

```{r eval = !knitr::is_latex_output(), child = here::here("prelims", "00--prelim.Rmd")}
```

```{r eval = !knitr::is_latex_output(), child = here::here("prelims", "00-abstract.Rmd")}
```

```{r, child = "data_prep.Rmd"}
```

```{r, child = "main_analysis.Rmd"}
```

<!-- The {.unnumbered} option here means that the introduction will be 
"Chapter 0." You can also use {-} for no numbers on chapters.
-->

# Introduction {.unnumbered}

Optimal matching, introduced by Andrew Abbott @Abbott-1986 and since then has been extensively used in social studies to answer questions about processes that take values in a categorical space and occur along a period of time. Particularly, in sociology there have been several studies following the professional career of groups of people (e.g. graduates from a specific college or professionals in a certain area).

The main objective of these studies is to find similarities and differences between the sequences and obtain groups of trajectories that have common elements to them by means of a clustering method applied to the matrix distance obtained by optimal matching.

In this work, we explore the possibility to obtain predictions of a secondary variable based on the information obtained from the sequential data via optimal matching using the `R` package `TraMineR`.

We describe the optimal matching algorithm, normalization options and the methods for obtaining the cost matrix in Section 1. In Section 2, we introduce the data used in this work and perform optimal matching to obtain groups of sequences. In Section 3, we describe the method used for prediction with the data from the previous section. Finally, in section 4, we show some other scenarios that produce better predictions.


-->
